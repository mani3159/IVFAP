{% extends 'base.html' %}
{% load static %}
{% block title %}Create Entry{% endblock %}

{% block content %}
<!-- Four Photos Row (Larger Circles) -->


<h2 style="text-align:center; color:#8e2916; font-weight:800; letter-spacing:1px; font-size:1.55rem; margin-bottom:16px;">
    International Vaish Federation Andhra Pradesh Unit
</h2>
<h3 style="text-align:center; color:#d37933; font-family:'Noto Sans Telugu', serif; margin-top:-10px; font-size:1rem;">
    ఇంటర్నేషనల్ వైశ్య ఫెడరేషన్
</h3>

<form id="presentationForm" method="POST" style="margin-top:28px; max-width: 500px;">
    {% csrf_token %}
    <div style="margin-bottom: 15px;">
        <label>Date: <input type="date" name="date" required value="{{ today }}"></label><br>
    </div>
    <div style="margin-bottom: 15px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">Name:</label>
        <input type="text" name="toname" required style="width: 100%; padding: 8px; box-sizing: border-box;">
    </div>
    <div style="margin-bottom: 15px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">Phno:</label>
        <input type="text" name="phno" maxlength="10" required style="width: 100%; padding: 8px; box-sizing: border-box;">
    </div>
    <div style="margin-bottom: 15px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">Aadharno:</label>
        <input type="text" name="aadharno" maxlength="12" required style="width: 100%; padding: 8px; box-sizing: border-box;">
    </div>
    <div style="margin-bottom: 15px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">Appointment:</label>
        <select name="ap" required style="width: 100%; padding: 8px; box-sizing: border-box;">
            <option value="YUVAJANA VIBHAG DISTRICT MEMBER">YUVAJANAVIBHAG DISTRICT MEMBER</option>
            <option value="YUVAJANA VIBHAG STATE MEMBER">YUVAJANAVIBHAG STATE MEMBER</option>
        </select>
    </div>
    <div style="margin-bottom: 15px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">Designation:</label>
        <input type="text" name="aptdas" maxlength="200" required style="width: 100%; padding: 8px; box-sizing: border-box;">
    </div>
    <div style="margin-bottom: 15px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">AP District:</label>
        <select name="ap_district" id="ap_district" required style="width: 100%; padding: 8px; box-sizing: border-box;">
            <option value="">Select District</option>
        </select>
    </div>
    <div style="margin-bottom: 15px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">AP Constitution:</label>
        <select name="ap_constitution" id="ap_constitution" required style="width: 100%; padding: 8px; box-sizing: border-box;">
            <option value="">Select Constitution</option>
        </select>
    </div>
    <div style="margin-bottom: 20px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">Address:</label>
        <textarea name="address" rows="4" cols="40" placeholder="Enter address here" required style="width: 100%; padding: 8px; box-sizing: border-box;"></textarea>
    </div>
    <div style="margin-bottom: 15px;">
        <label style="display:block; font-weight:600; margin-bottom: 5px;">Pincode:</label>
        <input type="text" name="pincode" maxlength="10" required style="width: 100%; padding: 8px; box-sizing: border-box;">
    </div>
    <button type="submit"
            style="background:#fbb216; color:#431c08; font-weight:700; border:none; border-radius:6px; padding:9px 38px; font-size:1rem; box-shadow:0 2px 5px #f0eaa6; cursor:pointer;">
        Submit
    </button>
</form>

<script>
// Dictionary of districts and their constituencies
const CONSTITUENCIES_BY_DISTRICT = {
    // ... districts as provided earlier ...
};

// Populate district dropdown
window.onload = function() {
    var apDistrict = document.getElementById('ap_district');
    for (let district in CONSTITUENCIES_BY_DISTRICT) {
        let opt = document.createElement('option');
        opt.value = district;
        opt.innerText = district;
        apDistrict.appendChild(opt);
    }
}

// When district changes, update constitutions
document.getElementById('ap_district').addEventListener('change', function() {
    var selected = this.value;
    var constitution = document.getElementById('ap_constitution');
    constitution.innerHTML = '<option value="">Select Constitution</option>';
    if (selected && CONSTITUENCIES_BY_DISTRICT[selected]) {
        CONSTITUENCIES_BY_DISTRICT[selected].forEach(function(c) {
            let opt = document.createElement('option');
            opt.value = c;
            opt.innerText = c;
            constitution.appendChild(opt);
        });
    }
});

// Frontend validation
function validateForm() {
    const form = document.getElementById("presentationForm");
    const date = form.elements["date"].value.trim();
    const toname = form.elements["toname"].value.trim();
    const phno = form.elements["phno"].value.trim();
    const aadharno = form.elements["aadharno"].value.trim();
    const ap = form.elements["ap"].value.trim();
    const aptdas = form.elements["aptdas"].value.trim();
    const apDistrict = form.elements["ap_district"].value.trim();
    const apConstitution = form.elements["ap_constitution"].value.trim();
    const address = form.elements["address"].value.trim();

    if (!date || !toname || !phno || !aadharno || !ap || !aptdas || !apDistrict || !apConstitution || !address) {
        alert("All fields are required.");
        return false;
    }
    const phnoPattern = /^\d{10}$/;
    if (!phnoPattern.test(phno)) {
        alert("Phone number must be exactly 10 digits.");
        return false;
    }
    const aadharPattern = /^\d{12}$/;
    if (!aadharPattern.test(aadharno)) {
        alert("Aadhar number must be exactly 12 digits.");
        return false;
    }
    return true;
}
</script>
{% endblock %}

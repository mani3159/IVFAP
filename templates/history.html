{% extends 'base.html' %}
{% block title %}History{% endblock %}

{% block content %}
<h2 style="text-align:center; color:#8e2916; margin-bottom:15px; font-size:1.7rem; letter-spacing:1.2px;">Track History</h2>

<form method="get" style="margin-bottom: 1.5em; text-align:center;">
    <input type="text" name="search_id" style="font-size:1rem; padding:8px 15px; border-radius:8px; border:2px solid #fbb216; width:220px;" placeholder="Search by Entry ID (e.g., IVF1)" value="{{ search_term }}" />
    <button type="submit" style="background:#fbb216; color:#431c08; font-weight:600; border:none; border-radius:6px; padding:8px 20px;">
        Search
    </button>
</form>
{% if not_found %}
    <p style="color: #d22828; font-weight:600; text-align:center;">No results found.</p>
{% endif %}
<div style="text-align:right;margin-bottom:14px;">
    <a href="{% url 'export_excel' %}">
        <button style="background: #3f2f06; color:#fff9e6; font-weight:700; border:none; border-radius:6px; padding:9px 26px; font-size:1rem;">Download Excel</button>
    </a>
</div>
<div style="overflow-x:auto;">
<table style="
    border-collapse: separate;
    border-spacing: 0;
    width: 100%;
    background: #fffbe9;
    box-shadow: 0 2px 9px #e1e1b9;
    border-radius:15px;
    overflow:hidden;
    font-size:0.98rem;">
    <thead>
        <tr style="background:#fbb216; color:#3f2913;">
            <th style="padding:12px 13px;">Entry&nbsp;ID</th>
            <th style="padding:12px 13px;">Date</th>
            <th style="padding:12px 13px;">To Name</th>
            <th style="padding:12px 13px;">Phone No</th>
            <th style="padding:12px 13px;">Aadhar No</th>
            <th style="padding:12px 13px;">AP1</th>
            <th style="padding:12px 13px;">AP2</th>
            <th style="padding:12px 13px;">Appointment Designation</th>
            <th style="padding:12px 13px;">Created At</th>
            <th style="padding:12px 13px;">Download</th>
        </tr>
    </thead>
    <tbody>
        {% for entry in entries %}
        <tr style="border-bottom:1.5px solid #faf0c6; text-align:center; height:39px;">
            <td style="padding:9px 8px; font-weight:700; background:#fff7d3;">{{ entry.entry_id }}</td>
            <td style="padding:9px 8px;">{{ entry.date }}</td>
            <td style="padding:9px 8px;">{{ entry.toname }}</td>
            <td style="padding:9px 8px; font-family:'Segoe UI',sans-serif;">{{ entry.phno }}</td>
            <td style="padding:9px 8px; font-family:'Segoe UI',sans-serif;">{{ entry.aadharno }}</td>
            <td style="padding:9px 8px;">{{ entry.ap1 }}</td>
            <td style="padding:9px 8px;">{{ entry.ap2 }}</td>
            <td style="padding:9px 8px;">{{ entry.aptdas }}</td>
            <td style="padding:9px 8px; font-size:0.96em;">{{ entry.created_at }}</td>
            <td style="padding:9px 8px;">
                <a href="{% url 'history_download_png' entry.pk %}">
                    <button style="background:#fb9e16; color:#4c2009; font-weight:600; border:none; border-radius:5px; padding:8px 16px;">
                        Download&nbsp;PNG
                    </button>
                </a>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="10" style="padding:20px 0; text-align:center;">No entries found.</td></tr>
        {% endfor %}
    </tbody>
</table>
</div>
{% endblock %}
